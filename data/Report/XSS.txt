Для предотвращения XSS необходимо отделять непроверенные данные от активного контента браузера. Этого можно достичь следующими способами:
1) Всегда кодировать и экранировать пользовательский ввод (используя библиотеку кодирования безопасности).
2) Использовать флаг cookie HTTPOnly для защиты от кражи файлов cookie.
3) Экранировать теги <script>. 
4) Использовать политику защиты содержимого (CSP) для предотвращения XSS.
Более подробная информация:
https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet